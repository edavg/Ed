---
import "@fontsource-variable/onest";
import Nav from "../components/nav.astro";
import Footer from "../components/footer.astro";

interface Props {
  title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang="es-PY">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Astro description" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/developer.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
  </head>
  <body
    style="overflow: hidden;"
    class="text-textPrimary bg-slate-950 font-medium antialiased selection:mix-blend-difference selection:bg-yellow-50 selection:text-slate-800"
  >
    <div
      dir="rtl"
      data-page="transition"
      class="h-screen grid lg:grid-cols-3 fixed inset-0 z-[999] text-2xl md:text-3xl lg:text-5xl font-bold"
    >
      <div class="h-full w-full bg-slate-950"></div>
      <div
        class="h-full relative overflow-hidden w-full grid place-items-center bg-slate-950"
      >
        <span class="preLoader"></span>
      </div>
      <div class="h-full w-full bg-slate-950"></div>
    </div>

    <div class="fixed left-0 top-0 -z-10 h-full w-full">
      <div class="relative h-full w-full">
        <div
          class="move absolute bottom-0 left-[0] top-[-10%] h-[500px] w-[500px] rounded-full bg-[radial-gradient(circle_farthest-side,rgba(69,87,189,0.15),rgba(255,255,255,0))]"
        >
        </div>
        <div
          class="move absolute bottom-0 hidden md:block right-[-0%] top-[-10%] h-[500px] w-[500px] rounded-full bg-[radial-gradient(circle_farthest-side,rgba(69,87,189,0.15),rgba(255,255,255,0))]"
        >
        </div>
        <div
          class="move absolute hidden md:block left-[10%] bottom-[-10%] h-[500px] w-[500px] rounded-full bg-[radial-gradient(circle_farthest-side,rgba(69,87,189,0.15),rgba(255,255,255,0))]"
        >
        </div>
      </div>
    </div>
    <Nav />
    <main class="relative max-w-6xl mx-auto px-4 md:px-6">
      <slot />
    </main>
    <Footer />

    <script>
      import gsap from "gsap";
      import Lenis from "@studio-freight/lenis";

      const lenis = new Lenis();
      const raf = (time: any) => {
        lenis.raf(time);

        requestAnimationFrame(raf);
      };

      requestAnimationFrame(raf);

      function GetSizes() {
        let width = window.innerWidth;
        return width > 765 ? "inset(0 0 0 100%)" : "inset(0 50% 0 50%)";
      }

      let loading = true;

      document.addEventListener("DOMContentLoaded", () => {
        const intro = document.querySelector(
          '[data-page="transition"]'
        ) as HTMLDivElement;
        const preLoader = document.querySelector(
          ".preLoader"
        ) as HTMLSpanElement;

        const introDivs = document.querySelectorAll(
          '[data-page="transition"] div'
        );

        if (!sessionStorage.getItem("preload")) {
          sessionStorage.setItem("preload", "true");

          const saludos = [
            "Welcome",
            "Bienvenue",
            "Benvenuto",
            "Bem-vindo",
            "Willkommen",
            "Welkom",
            "Witaj",
            "Vítejte",
            "Välkommen",
            "Velkommen",
            "Tervetuloa",
            "Üdvözöljük",
            "Hoş geldiniz",
            "환영합니다",
            "ようこそ",
            "أهلاً وسهلاً",
            "Добро пожаловать",
          ];
          let currentSaludo = 0;

          setTimeout(() => {
            const saludoInterval = setInterval(() => {
              preLoader.textContent = saludos[currentSaludo];

              currentSaludo++;

              if (currentSaludo >= saludos.length) {
                clearInterval(saludoInterval);

                gsap.to(preLoader, {
                  opacity: 0,
                  duration: 0.5,
                  onComplete: () => {
                    preLoader.textContent = "Bienvenido";
                    gsap.to(preLoader, {
                      opacity: 1,
                      duration: 0.5,
                    });
                  },
                });

                introDivs.forEach((div) => {
                  gsap.to(div, {
                    clipPath: GetSizes(),
                    overflow: "hidden",
                    delay: 1.5,
                    duration: 1.5,
                    ease: "power2.inOut",
                    onComplete: () => {
                      intro.style.display = "none";
                      document.body.style.overflow = "auto";
                      loading = false;
                      gsap.from(".ed", {
                        opacity: 0,
                        duration: 3,
                      });
                    },
                  });
                });
              }
            }, 150);
          }, 600);
        } else {
          intro.style.display = "none";
          document.body.style.overflow = "auto";
          loading = false;

          gsap.from(".ed", {
            opacity: 0,
            duration: 1,
          });
        }
      });
    </script>

    <style is:global>
      ::-webkit-scrollbar {
        display: none;
      }
    </style>
  </body>
</html>
